// prisma/schema.prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Tuning {
  CF
  AD
  DG
}

enum Scale {
  E_dur
  A_dur
  D_dur
  G_dur
  C_dur
  F_dur
  B_dur
  Es_dur
  As_dur
}

enum SheetAccess {
  public
  private
}

model User {
  id             String  @id
  nickname       String?
  authoredSheets Sheet[] @relation("author")
  likedSheets    Sheet[] @relation("like")

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
}

model Tag {
  id     Int     @id @default(autoincrement())
  name   String
  sheets Sheet[]
}

enum SongAuthorType {
  folk_song
  original_song
}

enum Genre {
  folk_music
  country
  sea_shanty
}

enum Country {
  slovakia
  czech_republic
  poland
  hungary
  austria
  ireland
  scotland
  england
  france
}

model Sheet {
  id          Int         @id @default(autoincrement())
  name        String
  description String?
  tuning      Tuning
  content     Json
  version     Int
  sourceText  String?
  sourceUrl   String?
  scale       Scale?
  tempo       Int?
  access      SheetAccess @default(public)
  genre       Genre?
  country     Country?

  songAuthorType SongAuthorType @default(folk_song)
  // Song author (band, singer...)
  songAuthor     String?

  // Author of note sheet representation
  noteSheetAuthor String?

  // Author of tabulator sheet
  SheetAuthor   User   @relation("author", fields: [sheetAuthorId], references: [id])
  sheetAuthorId String @map("authorId")

  Likers User[] @relation("like")
  Tags   Tag[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
}
